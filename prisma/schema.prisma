generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

// 1. Core Student / User Table
model Student {
  id            Int    @id @default(autoincrement())
  applicationNo String @unique @db.VarChar(10)
  fullName      String @db.VarChar(255)
  email         String @unique @db.VarChar(255)
  mobileNumber  String @unique @db.VarChar(15)
  password      String @db.VarChar(255)

  // Tracking Fields
  createdAt       DateTime @default(now())
  paymentStatus   String   @default("pending")
  isFormSubmitted Boolean  @default(false)
  selectedCourse  String?

  bbaApplications BbaApplication[]
  mbaApplications MbaApplication[]
}

// 2. BBA Application Table
model BbaApplication {
  id        Int     @id @default(autoincrement())
  studentId Int
  student   Student @relation(fields: [studentId], references: [id])

  // Applicant Details - Optional for initialization
  fullName      String? @db.VarChar(255)
  gender        String? @db.VarChar(20)
  dateOfBirth   String? @db.VarChar(50)
  category      String? @db.VarChar(50)
  nationality   String? @db.VarChar(50)
  aadhaarNumber String? @db.VarChar(20)
  mobileNumber  String? @db.VarChar(15)
  email         String? @db.VarChar(255)

  // Address
  permanentAddress String? @db.Text
  corrAddressLine  String? @db.VarChar(255)
  corrState        String? @db.VarChar(100)
  corrDistrict     String? @db.VarChar(100)
  corrPinCode      String? @db.VarChar(10)

  // Parents/Guardian
  fatherName       String?
  fatherMobile     String?
  fatherOccupation String?
  fatherIncome     String?
  motherName       String?
  motherMobile     String?
  motherOccupation String?
  motherIncome     String?
  guardianName     String?
  guardianRelation String?
  guardianMobile   String?
  guardianAddress  String? @db.Text

  // Academics
  c10Board      String?
  c10School     String?
  c10Year       String?
  c10MaxMarks   String?
  c10MarksObt   String?
  c10Percentage String?

  c12Board      String?
  c12School     String?
  c12Year       String?
  c12MaxMarks   String?
  c12MarksObt   String?
  c12Percentage String?
  otherQual     String? @db.Text

  // Eligibility & Hostel
  passed10Plus2   String? @default("No")
  hostelRequired  String? @default("No")
  hostelType      String?
  guardianConsent String? @default("No")

  declaration String?  @default("false")
  status      String   @default("pending")
  createdAt   DateTime @default(now())
}

// 3. MBA Application Table
model MbaApplication {
  id        Int     @id @default(autoincrement())
  studentId Int
  student   Student @relation(fields: [studentId], references: [id])

  // --- 1. Registration Data (Identity) ---
  firstName     String? @db.VarChar(100)
  middleName    String? @db.VarChar(100)
  lastName      String? @db.VarChar(100)
  gender        String? @db.VarChar(20)
  dateOfBirth   String? @db.VarChar(50)
  bloodGroup    String? @db.VarChar(10)
  category      String? @db.VarChar(50)
  nationality   String? @db.VarChar(50)
  aadhaarNumber String? @db.VarChar(20)
  panNumber     String? @db.VarChar(20)
  mobileNumber  String? @db.VarChar(15)

  // --- 2. Family & Address Data ---
  // Permanent Address
  permAddressLine1  String? @db.VarChar(255)
  permCity          String? @db.VarChar(100)
  permPostOffice    String? @db.VarChar(100)
  permPoliceStation String? @db.VarChar(100)
  permDistrict      String? @db.VarChar(100)
  permState         String? @default("Assam") @db.VarChar(100)
  permPinCode       String? @db.VarChar(10)

  // Correspondence Address
  correspondenceSameAsPermanent String @default("false")
  corrAddressLine1              String? @db.VarChar(255)
  corrCity                      String? @db.VarChar(100)
  corrPostOffice                String? @db.VarChar(100)
  corrPoliceStation             String? @db.VarChar(100)
  corrDistrict                  String? @db.VarChar(100)
  corrState                     String? @default("Assam") @db.VarChar(100)
  corrPinCode                   String? @db.VarChar(10)

  // Parents & Guardian
  fatherName         String?
  fatherMobile       String?
  fatherOccupation   String?
  motherName         String?
  motherMobile       String?
  motherOccupation   String?
  guardianName       String?
  guardianRelation   String?
  guardianMobile     String?
  guardianOccupation String?
  guardianAddress    String? @db.Text

  // Hostel
  hostelRequired   String? @default("no")
  hostelType       String?
  hostelSpecialReq String? @db.Text

  // --- 3. Academic & Work Data ---
  qualifyingExams     String? @db.Text // Store as comma-separated string or JSON string
  qualifyingExamOther String?
  qualifyingExamScore String?
  degree              String?
  degreeOther         String?
  specialisation      String?

  // These store the JSON.stringify() version of your arrays
  academicRows       String? @db.Text
  workExperienceRows String? @db.Text

  cgpa              String?
  conversionFormula String?
  extraCurricular   String? @db.Text
  hasWorkExperience String? @default("no")

  // --- 4. Documents Data (Paths) ---
  photoUrl            String? @db.VarChar(500)
  signatureUrl        String? @db.VarChar(500)
  marksheet10Url      String? @db.VarChar(500)
  marksheet12Url      String? @db.VarChar(500)
  marksheetGradUrl    String? @db.VarChar(500)
  casteCertificateUrl String? @db.VarChar(500)

  // --- 5. Status & Declaration ---
  declaration String?  @default("false")
  status      String?   @default("pending")
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

// --- Admin & Gallery ---
model Gallery {
  id           Int      @id @default(autoincrement())
  image        String   @db.VarChar(500)
  title        String   @db.VarChar(255)
  category     String   @db.VarChar(50)
  description  String?  @db.Text
  displayOrder Int      @default(0)
  isActive     Boolean  @default(true)
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt

  @@map("gallery")
}

model AdminUser {
  id        Int       @id @default(autoincrement())
  username  String    @unique @db.VarChar(100)
  email     String    @unique @db.VarChar(255)
  password  String    @db.VarChar(255)
  role      String    @default("moderator")
  isActive  Boolean   @default(true)
  lastLogin DateTime?
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt

  @@map("admin_users")
}
