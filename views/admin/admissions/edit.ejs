<% 
  const isMba = !!admission.firstName;
  const displayName = isMba ? `${admission.firstName} ${admission.lastName}` : admission.fullName;
  const title = 'Edit Admission';
  const pageTitle = 'Edit Admission';
  const pageDescription = `Editing ${isMba ? 'MBA' : 'BBA'} application for ${displayName}`;
%>

<div class="max-w-5xl mx-auto pb-10">
  <a href="/admin/admissions/<%= isMba ? 'mba' : 'bba' %>/<%= admission.id %>" class="inline-flex items-center text-blue-600 hover:text-blue-700 mb-6 font-medium">
    <i class="fas fa-arrow-left mr-2"></i>Back to Details
  </a>

  <form action="/admin/admissions/<%= isMba ? 'mba' : 'bba' %>/<%= admission.id %>/update" method="POST" enctype="multipart/form-data" class="space-y-8">
    
    <div class="bg-white rounded-xl shadow-md overflow-hidden border border-gray-200">
      <div class="bg-gradient-to-r from-blue-600 to-blue-700 px-6 py-4">
        <h3 class="text-lg font-bold text-white"><i class="fas fa-user-circle mr-2"></i>Personal Information</h3>
      </div>
      <div class="p-6 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        
        <% if (isMba) { %>
          <div>
            <label class="block text-xs font-bold text-gray-500 uppercase mb-1">First Name</label>
            <input type="text" name="firstName" value="<%= admission.firstName %>" required class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500">
          </div>
          <div>
            <label class="block text-xs font-bold text-gray-500 uppercase mb-1">Middle Name</label>
            <input type="text" name="middleName" value="<%= admission.middleName %>" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500">
          </div>
          <div>
            <label class="block text-xs font-bold text-gray-500 uppercase mb-1">Last Name</label>
            <input type="text" name="lastName" value="<%= admission.lastName %>" required class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500">
          </div>
        <% } else { %>
          <div class="md:col-span-2">
            <label class="block text-xs font-bold text-gray-500 uppercase mb-1">Full Name</label>
            <input type="text" name="fullName" value="<%= admission.fullName %>" required class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500">
          </div>
        <% } %>

        <div>
          <label class="block text-xs font-bold text-gray-500 uppercase mb-1">Date of Birth</label>
          <input type="text" name="dateOfBirth" value="<%= admission.dateOfBirth %>" placeholder="DD-MM-YYYY" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500">
        </div>

        <div>
          <label class="block text-xs font-bold text-gray-500 uppercase mb-1">Gender</label>
          <select name="gender" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500">
            <option value="Male" <%= admission.gender === 'Male' ? 'selected' : '' %>>Male</option>
            <option value="Female" <%= admission.gender === 'Female' ? 'selected' : '' %>>Female</option>
            <option value="Other" <%= admission.gender === 'Other' ? 'selected' : '' %>>Other</option>
          </select>
        </div>

        <div>
          <label class="block text-xs font-bold text-gray-500 uppercase mb-1">Blood Group</label>
          <input type="text" name="bloodGroup" value="<%= admission.bloodGroup %>" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500">
        </div>
      </div>
    </div>

    <div class="bg-white rounded-xl shadow-md overflow-hidden border border-gray-200">
      <div class="bg-gradient-to-r from-green-600 to-green-700 px-6 py-4">
        <h3 class="text-lg font-bold text-white"><i class="fas fa-address-book mr-2"></i>Family & Contact</h3>
      </div>
      <div class="p-6 grid grid-cols-1 md:grid-cols-2 gap-6">
        <div>
          <label class="block text-xs font-bold text-gray-500 uppercase mb-1">Father's Name</label>
          <input type="text" name="fatherName" value="<%= admission.fatherName %>" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500">
        </div>
        <div>
          <label class="block text-xs font-bold text-gray-500 uppercase mb-1">Mother's Name</label>
          <input type="text" name="motherName" value="<%= admission.motherName %>" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500">
        </div>
        <div>
          <label class="block text-xs font-bold text-gray-500 uppercase mb-1">Mobile Number</label>
          <input type="tel" name="mobileNumber" value="<%= admission.mobileNumber %>" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500">
        </div>
        <div>
          <label class="block text-xs font-bold text-gray-500 uppercase mb-1">Email</label>
          <input type="email" name="email" value="<%= admission.email || admission.student?.email %>" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500">
        </div>

        <% if (isMba) { %>
          <div class="md:col-span-2">
            <label class="block text-xs font-bold text-gray-500 uppercase mb-1">Permanent Address</label>
            <textarea name="permAddressLine1" rows="2" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500"><%= admission.permAddressLine1 %></textarea>
          </div>
        <% } %>
      </div>
    </div>

    <div class="bg-white rounded-xl shadow-md overflow-hidden border border-gray-200">
      <div class="bg-gradient-to-r from-indigo-600 to-indigo-700 px-6 py-4 text-white">
        <h3 class="text-lg font-bold">Profile Media</h3>
      </div>
      <div class="p-6 grid grid-cols-1 md:grid-cols-2 gap-8">
        <div class="flex items-start space-x-4">
          <% if (admission.photoUrl) { %>
            <img src="/<%= admission.photoUrl %>" class="w-24 h-24 object-cover rounded border">
          <% } %>
          <div class="flex-1">
            <label class="block text-xs font-bold text-gray-500 uppercase mb-1">Update Photo</label>
            <input type="file" name="photo" class="text-sm">
          </div>
        </div>
        <div class="flex items-start space-x-4">
          <% if (admission.signatureUrl) { %>
            <img src="/<%= admission.signatureUrl %>" class="w-24 h-12 object-contain bg-gray-50 border rounded">
          <% } %>
          <div class="flex-1">
            <label class="block text-xs font-bold text-gray-500 uppercase mb-1">Update Signature</label>
            <input type="file" name="signature" class="text-sm">
          </div>
        </div>
      </div>
    </div>

    <div class="flex items-center space-x-4">
      <button type="submit" class="px-8 py-3 bg-blue-600 text-white font-bold rounded-lg hover:bg-blue-700 shadow-lg transition">
        <i class="fas fa-save mr-2"></i>Update Application
      </button>
      <a href="/admin/admissions/<%= isMba ? 'mba' : 'bba' %>/<%= admission.id %>" class="px-8 py-3 bg-white text-gray-600 border rounded-lg hover:bg-gray-50">
        Cancel
      </a>
    </div>
  </form>
</div>